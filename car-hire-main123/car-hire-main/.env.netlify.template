# üîê Environment Variables Template for Netlify

Copy this template and fill in your actual values, then add them to Netlify.

## üìç Where to Add These

**Netlify Dashboard**:
1. Go to your site in [Netlify](https://app.netlify.com/)
2. Navigate to: **Site configuration** ‚Üí **Environment variables**
3. Click **"Add a variable"** for each variable below
4. ‚ö†Ô∏è **IMPORTANT**: Enable both **"Builds"** and **"Functions"** scopes for each variable!

---

## ‚úÖ Required Variables

### MongoDB Database Configuration

```bash
# Your MongoDB Atlas connection string
# Get this from: MongoDB Atlas ‚Üí Cluster ‚Üí Connect ‚Üí Connect your application
MONGODB_URI=mongodb+srv://USERNAME:PASSWORD@cluster0.xxxxx.mongodb.net/?retryWrites=true&w=majority

# Database name (default is fine for most cases)
DB_NAME=car-hire
```

### Authentication & Security

```bash
# JWT secret for authentication (generate a secure random string)
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
JWT_SECRET=YOUR_SECURE_RANDOM_STRING_HERE_MINIMUM_32_CHARACTERS
```

---

## ‚öôÔ∏è Optional Variables (M-Pesa Payments)

**Only add these if you want to enable M-Pesa mobile payments**

### M-Pesa Credentials

```bash
# Get these from: https://developer.safaricom.co.ke/ ‚Üí My Apps
MPESA_CONSUMER_KEY=your_consumer_key_from_daraja_portal
MPESA_CONSUMER_SECRET=your_consumer_secret_from_daraja_portal

# Lipa Na M-Pesa Online Passkey (from Daraja Portal)
MPESA_PASSKEY=your_mpesa_passkey_here

# Business shortcode
# For testing: use 174379 (Daraja sandbox)
# For production: use your Till Number from Safaricom
MPESA_SHORTCODE=174379

# Callback URL - where M-Pesa sends payment notifications
# ‚ö†Ô∏è UPDATE THIS after first deployment with your actual Netlify URL!
# Format: https://YOUR-SITE-NAME.netlify.app/api/mpesa/callback
MPESA_CALLBACK_URL=https://YOUR-SITE-NAME.netlify.app/api/mpesa/callback

# Environment: 'sandbox' for testing, 'production' for live payments
MPESA_ENV=sandbox
```

---

## üìù How to Fill This Out

### Step 1: MongoDB URI

1. Login to [MongoDB Atlas](https://cloud.mongodb.com/)
2. Click your cluster
3. Click **"Connect"**
4. Choose **"Connect your application"**
5. Copy the connection string
6. Replace `<password>` with your actual MongoDB password
7. Replace `USERNAME` with your MongoDB username

**Example**:
```
mongodb+srv://myuser:MySecurePass123@cluster0.abc123.mongodb.net/?retryWrites=true&w=majority
```

### Step 2: JWT Secret

Run this command in your terminal:

```bash
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```

Copy the output (will look like: `a3f8b2c4d5e6f7g8h9i0j1k2l3m4n5o6...`)

### Step 3: M-Pesa (Optional)

1. Create account at [Daraja Portal](https://developer.safaricom.co.ke/)
2. Create a new app
3. Navigate to **"My Apps"** ‚Üí Select your app
4. Copy **Consumer Key** and **Consumer Secret**
5. Under **"Lipa Na M-Pesa Online"**, copy **Passkey**
6. For testing, use shortcode `174379`
7. Leave `MPESA_CALLBACK_URL` empty for now (update after first deployment)
8. Set `MPESA_ENV` to `sandbox` for testing

---

## üéØ Complete Example

Here's what a complete configuration looks like (with fake values):

```bash
# Required
MONGODB_URI=mongodb+srv://johndoe:SecurePassword123@cluster0.abc123.mongodb.net/?retryWrites=true&w=majority
DB_NAME=car-hire
JWT_SECRET=a3f8b2c4d5e6f7g8h9i0j1k2l3m4n5o6p7q8r9s0t1u2v3w4x5y6z7a8b9c0d1e2

# Optional M-Pesa
MPESA_CONSUMER_KEY=xvPZt4vG8K9lMr2qN3pO4sR5tU6vW7yX
MPESA_CONSUMER_SECRET=A1B2C3D4E5F6G7H8I9J0K1L2M3N4O5P6
MPESA_PASSKEY=bfb279f9aa9bdbcf158e97dd71a467cd2e0c893059b10f78e6b72ada1ed2c919
MPESA_SHORTCODE=174379
MPESA_CALLBACK_URL=https://spaceborne-car-hire.netlify.app/api/mpesa/callback
MPESA_ENV=sandbox
```

---

## ‚ö†Ô∏è Important Security Notes

### DO ‚úÖ
- ‚úÖ Keep this file private (never commit to Git)
- ‚úÖ Use different values for development vs production
- ‚úÖ Generate a long, random JWT secret (32+ characters)
- ‚úÖ Use strong MongoDB password
- ‚úÖ Use sandbox M-Pesa for testing first
- ‚úÖ Store these only in Netlify (encrypted)

### DON'T ‚ùå
- ‚ùå Never commit `.env` files to Git
- ‚ùå Never share these values publicly
- ‚ùå Never use production M-Pesa credentials for testing
- ‚ùå Never use simple/predictable secrets
- ‚ùå Never hardcode these in your source code

---

## üîÑ Updating MPESA_CALLBACK_URL After Deployment

After your first deployment to Netlify:

1. **Note your Netlify URL**: It will be something like:
   ```
   https://amazing-name-123456.netlify.app
   ```

2. **Update the callback variable**:
   - Go to Netlify ‚Üí Site configuration ‚Üí Environment variables
   - Find `MPESA_CALLBACK_URL`
   - Click **"Edit"**
   - Change to: `https://YOUR-ACTUAL-URL.netlify.app/api/mpesa/callback`
   - Save

3. **Redeploy**:
   - Go to **Deploys** tab
   - Click **"Trigger deploy"** ‚Üí **"Deploy site"**

---

## ‚úÖ Verification

After adding all variables to Netlify, verify:

- [ ] All required variables added
- [ ] Each variable has **"Functions"** scope enabled
- [ ] Each variable has **"Builds"** scope enabled  
- [ ] No typos in variable names (they're case-sensitive!)
- [ ] MongoDB URI includes password
- [ ] JWT_SECRET is long and random
- [ ] M-Pesa variables match your Daraja app (if using)
- [ ] Callback URL will be updated after first deployment

---

## üîç Variable Name Reference

**Required** (3 variables):
1. `MONGODB_URI`
2. `DB_NAME`
3. `JWT_SECRET`

**Optional M-Pesa** (6 variables):
4. `MPESA_CONSUMER_KEY`
5. `MPESA_CONSUMER_SECRET`
6. `MPESA_PASSKEY`
7. `MPESA_SHORTCODE`
8. `MPESA_CALLBACK_URL`
9. `MPESA_ENV`

**Total**: 3 required + 6 optional = **9 variables maximum**

---

## üÜò Need Help?

- **MongoDB issues**: Check [`NETWORK_ACCESS_GUIDE.md`](file:///c:/Users/Administrator/Documents/car-hire-main123/car-hire-main123/car-hire-main/NETWORK_ACCESS_GUIDE.md)
- **M-Pesa setup**: See [`MPESA_SETUP_GUIDE.md`](file:///c:/Users/Administrator/Documents/car-hire-main123/car-hire-main123/car-hire-main/MPESA_SETUP_GUIDE.md)
- **Full details**: Read [`ENVIRONMENT_VARIABLES.md`](file:///c:/Users/Administrator/Documents/car-hire-main123/car-hire-main123/car-hire-main/ENVIRONMENT_VARIABLES.md)

---

**Ready to add these to Netlify?** Follow the deployment checklist in [`DEPLOYMENT_CHECKLIST_QUICK.md`](file:///c:/Users/Administrator/Documents/car-hire-main123/car-hire-main123/car-hire-main/DEPLOYMENT_CHECKLIST_QUICK.md)
